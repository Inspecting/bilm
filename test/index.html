<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Viewer</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#8000ff">
<style>
    body {
        background-color: #1a001f;
        color: white;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
    }
    .navbar {
        height: 50px;
        background-color: #2a0033;
    }
    .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
    }
    .player-container {
        position: relative;
        border-radius: 15px;
        padding: 10px;
        background: linear-gradient(145deg, #3a0050, #1a001f);
        box-shadow: 0 0 20px #8000ff;
    }
    iframe {
        width: 100%;
        height: 500px;
        border-radius: 10px;
        border: none;
    }
    .selector-bar, .bottom-bar {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
        align-items: center;
        background-color: #2a0033;
        padding: 10px;
        border-radius: 10px;
        margin-top: 10px;
        box-shadow: 0 0 15px #8000ff;
    }
    select, button {
        padding: 8px 12px;
        border: none;
        border-radius: 8px;
        background-color: #4b0082;
        color: white;
        cursor: pointer;
        font-size: 14px;
    }
    button:disabled {
        background-color: #3a003d;
        cursor: not-allowed;
        opacity: 0.6;
    }
    .bottom-bar {
        justify-content: flex-end;
    }
    .fullscreen-btn {
        margin-left: auto;
        background: none;
        font-size: 18px;
        padding: 5px;
        cursor: pointer;
    }
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
<div class="navbar"></div>
<div class="container">
    <div class="player-container">
        <iframe id="player" data-src="" allowfullscreen></iframe>
        <div class="selector-bar">
            <button id="prevSeason">⏮ Season</button>
            <select id="seasonSelect"></select>
            <button id="nextSeason">Season ⏭</button>
            <button id="prevEpisode">⏮ Episode</button>
            <select id="episodeSelect"></select>
            <button id="nextEpisode">Episode ⏭</button>
            <button id="serverToggle">Change Server</button>
        </div>
        <div class="bottom-bar">
            <button class="fullscreen-btn" id="fullscreenBtn"><i class="fas fa-expand"></i></button>
        </div>
    </div>
</div>
<script>
    const seasonSelect = document.getElementById('seasonSelect');
    const episodeSelect = document.getElementById('episodeSelect');
    const prevSeason = document.getElementById('prevSeason');
    const nextSeason = document.getElementById('nextSeason');
    const prevEpisode = document.getElementById('prevEpisode');
    const nextEpisode = document.getElementById('nextEpisode');
    const serverToggle = document.getElementById('serverToggle');
    const player = document.getElementById('player');
    const fullscreenBtn = document.getElementById('fullscreenBtn');

    let currentSeason = parseInt(localStorage.getItem('season')) || 1;
    let currentEpisode = parseInt(localStorage.getItem('episode')) || 1;
    let currentServer = 1;
    let cooldown = false;

    const totalSeasons = 3;
    const episodesPerSeason = 10;

    function updateSelectors() {
        seasonSelect.innerHTML = '';
        episodeSelect.innerHTML = '';

        for (let s = 1; s <= totalSeasons; s++) {
            let opt = document.createElement('option');
            opt.value = s;
            opt.textContent = `Season ${s}`;
            if (s === currentSeason) opt.selected = true;
            seasonSelect.appendChild(opt);
        }
        for (let e = 1; e <= episodesPerSeason; e++) {
            let opt = document.createElement('option');
            opt.value = e;
            opt.textContent = `Episode ${e}`;
            if (e === currentEpisode) opt.selected = true;
            episodeSelect.appendChild(opt);
        }

        prevSeason.disabled = currentSeason === 1;
        nextSeason.disabled = currentSeason === totalSeasons;
        prevEpisode.disabled = currentEpisode === 1;
        nextEpisode.disabled = currentEpisode === episodesPerSeason;
    }

    function loadPlayer() {
        player.src = `https://example.com/embed/s${currentSeason}e${currentEpisode}?server=${currentServer}`;
        localStorage.setItem('season', currentSeason);
        localStorage.setItem('episode', currentEpisode);
    }

    function changeEpisode(delta) {
        if (cooldown) return;
        cooldown = true;
        setTimeout(() => cooldown = false, 1000);

        currentEpisode += delta;
        if (currentEpisode < 1) currentEpisode = 1;
        if (currentEpisode > episodesPerSeason) currentEpisode = episodesPerSeason;
        updateSelectors();
        loadPlayer();
    }

    function changeSeason(delta) {
        if (cooldown) return;
        cooldown = true;
        setTimeout(() => cooldown = false, 1000);

        currentSeason += delta;
        if (currentSeason < 1) currentSeason = 1;
        if (currentSeason > totalSeasons) currentSeason = totalSeasons;
        currentEpisode = 1;
        updateSelectors();
        loadPlayer();
    }

    seasonSelect.addEventListener('change', () => {
        currentSeason = parseInt(seasonSelect.value);
        currentEpisode = 1;
        updateSelectors();
        loadPlayer();
    });
    episodeSelect.addEventListener('change', () => {
        currentEpisode = parseInt(episodeSelect.value);
        updateSelectors();
        loadPlayer();
    });

    prevSeason.addEventListener('click', () => changeSeason(-1));
    nextSeason.addEventListener('click', () => changeSeason(1));
    prevEpisode.addEventListener('click', () => changeEpisode(-1));
    nextEpisode.addEventListener('click', () => changeEpisode(1));

    serverToggle.addEventListener('click', () => {
        currentServer = currentServer === 1 ? 2 : 1;
        loadPlayer();
    });

    fullscreenBtn.addEventListener('click', () => {
        if (player.requestFullscreen) player.requestFullscreen();
        else if (player.webkitRequestFullscreen) player.webkitRequestFullscreen();
        else if (player.msRequestFullscreen) player.msRequestFullscreen();
    });

    updateSelectors();
    loadPlayer();
</script>
<script>
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('service-worker.js');
    }
</script>
</body>
</html>
