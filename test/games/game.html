<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Game Details</title>
    <style>
      :root {
        color-scheme: light dark;
        --bg: #0f1115;
        --card: #171a21;
        --text: #e6e6e6;
        --muted: #a0a0a0;
        --accent: #5dd9c1;
        --accent-2: #6aa9ff;
        --shadow: 0 16px 40px rgba(0, 0, 0, 0.35);
      }

      [data-theme='light'] {
        --bg: #f7f7fb;
        --card: #ffffff;
        --text: #1b1b1f;
        --muted: #52525b;
        --accent: #0ea5e9;
        --accent-2: #7c3aed;
        --shadow: 0 12px 30px rgba(15, 23, 42, 0.15);
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Inter", "Segoe UI", system-ui, sans-serif;
        background: var(--bg);
        color: var(--text);
        min-height: 100vh;
      }

      header {
        padding: 28px 6vw;
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        align-items: center;
        justify-content: space-between;
      }

      header a {
        text-decoration: none;
        color: var(--text);
        padding: 10px 14px;
        background: var(--card);
        border-radius: 10px;
        box-shadow: var(--shadow);
      }

      header button {
        border: 1px solid rgba(93, 217, 193, 0.4);
        padding: 10px 14px;
        border-radius: 10px;
        background: var(--card);
        color: var(--text);
        cursor: pointer;
      }

      .hero {
        margin: 0 6vw;
        background: var(--card);
        border-radius: 22px;
        overflow: hidden;
        box-shadow: var(--shadow);
      }

      .hero img {
        width: 100%;
        height: 340px;
        object-fit: cover;
      }

      .hero-content {
        padding: 24px;
        display: grid;
        gap: 18px;
      }

      h1 {
        margin: 0;
      }

      .meta {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        color: var(--muted);
      }

      .pill {
        padding: 6px 12px;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.12);
        font-size: 0.8rem;
      }

      .section {
        margin: 32px 6vw;
        background: var(--card);
        border-radius: 18px;
        padding: 24px;
        box-shadow: var(--shadow);
      }

      .grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
      }

      .link {
        display: inline-flex;
        gap: 8px;
        align-items: center;
        color: var(--accent);
        text-decoration: none;
      }

      .loading,
      .error {
        padding: 60px;
        text-align: center;
        color: var(--muted);
      }

      .chips {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }

      .chip {
        padding: 6px 10px;
        border-radius: 999px;
        background: rgba(93, 217, 193, 0.18);
        font-size: 0.8rem;
      }
    </style>
  </head>
  <body>
    <header>
      <a href="./">← Back to games</a>
      <button id="toggle-theme">Toggle theme</button>
    </header>

    <div id="loading" class="loading">Loading game details…</div>
    <div id="error" class="error" hidden>Unable to load this game.</div>

    <section id="hero" class="hero" hidden>
      <img id="hero-image" alt="" />
      <div class="hero-content">
        <h1 id="title"></h1>
        <div class="meta" id="meta"></div>
        <div class="chips" id="genres"></div>
        <p id="description"></p>
        <a id="website" class="link" href="#" target="_blank" rel="noreferrer">Visit official site →</a>
      </div>
    </section>

    <section id="extras" class="section" hidden>
      <h2>Highlights</h2>
      <div class="grid" id="highlights"></div>
    </section>

    <section id="stores" class="section" hidden>
      <h2>Where to buy</h2>
      <div class="grid" id="store-list"></div>
    </section>

    <script>
      const apiKey = "3c83888951ef4d339550cc88bcaf681d";
      const apiBase = "https://api.rawg.io/api";

      const theme = localStorage.getItem("gameTheme") || "dark";
      document.documentElement.dataset.theme = theme;

      document.getElementById("toggle-theme").addEventListener("click", () => {
        const nextTheme = document.documentElement.dataset.theme === "dark" ? "light" : "dark";
        document.documentElement.dataset.theme = nextTheme;
        localStorage.setItem("gameTheme", nextTheme);
      });

      const params = new URLSearchParams(window.location.search);
      const gameId = params.get("id");

      const elements = {
        loading: document.getElementById("loading"),
        error: document.getElementById("error"),
        hero: document.getElementById("hero"),
        heroImage: document.getElementById("hero-image"),
        title: document.getElementById("title"),
        meta: document.getElementById("meta"),
        genres: document.getElementById("genres"),
        description: document.getElementById("description"),
        website: document.getElementById("website"),
        extras: document.getElementById("extras"),
        highlights: document.getElementById("highlights"),
        stores: document.getElementById("stores"),
        storeList: document.getElementById("store-list"),
      };

      const buildPill = (label) => {
        const pill = document.createElement("span");
        pill.className = "pill";
        pill.textContent = label;
        return pill;
      };

      const renderHighlights = (game) => {
        elements.highlights.innerHTML = "";
        const items = [
          { label: "Playtime", value: `${game.playtime || 0} hrs` },
          { label: "ESRB", value: game.esrb_rating?.name || "Not rated" },
          { label: "Suggestions", value: game.suggestions_count || 0 },
          { label: "Screenshots", value: game.screenshots_count || 0 },
        ];

        items.forEach((item) => {
          const card = document.createElement("div");
          card.innerHTML = `<strong>${item.label}</strong><p>${item.value}</p>`;
          elements.highlights.appendChild(card);
        });
      };

      const renderStores = (stores) => {
        elements.storeList.innerHTML = "";
        if (!stores.length) return;

        stores.forEach((store) => {
          const card = document.createElement("div");
          card.innerHTML = `
            <strong>${store.store.name}</strong>
            <p>${store.url ? "Available" : "Link coming soon"}</p>
            ${store.url ? `<a class="link" href="${store.url}" target="_blank" rel="noreferrer">Open store →</a>` : ""}
          `;
          elements.storeList.appendChild(card);
        });
      };

      const loadGame = async () => {
        if (!gameId) {
          elements.loading.hidden = true;
          elements.error.hidden = false;
          elements.error.textContent = "Missing game id.";
          return;
        }

        try {
          const response = await fetch(`${apiBase}/games/${gameId}?key=${apiKey}`);
          if (!response.ok) throw new Error("Unable to load game");
          const game = await response.json();

          elements.title.textContent = game.name;
          elements.heroImage.src = game.background_image || "https://images.unsplash.com/photo-1493711662062-fa541adb3fc8?auto=format&fit=crop&w=1200&q=60";
          elements.heroImage.alt = game.name;
          elements.description.innerHTML = game.description || "No description available.";

          elements.meta.append(
            buildPill(`⭐ ${game.rating?.toFixed(1) || "N/A"}`),
            buildPill(game.released || "TBA"),
            buildPill(game.metacritic ? `MC ${game.metacritic}` : "No score")
          );

          elements.genres.innerHTML = "";
          game.genres?.forEach((genre) => {
            const chip = document.createElement("span");
            chip.className = "chip";
            chip.textContent = genre.name;
            elements.genres.appendChild(chip);
          });

          if (game.website) {
            elements.website.href = game.website;
            elements.website.hidden = false;
          } else {
            elements.website.hidden = true;
          }

          renderHighlights(game);
          elements.extras.hidden = false;

          const storesResponse = await fetch(`${apiBase}/games/${gameId}/stores?key=${apiKey}`);
          const storesData = await storesResponse.json();
          if (storesData.results?.length) {
            renderStores(storesData.results);
            elements.stores.hidden = false;
          }

          elements.loading.hidden = true;
          elements.hero.hidden = false;
        } catch (error) {
          elements.loading.hidden = true;
          elements.error.hidden = false;
          elements.error.textContent = error.message;
        }
      };

      loadGame();
    </script>
  </body>
</html>
