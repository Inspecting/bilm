<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Tap Dash</title>
    <style>
      :root {
        color-scheme: light dark;
        --bg: #0b0d14;
        --panel: #141826;
        --text: #f8fafc;
        --accent: #5dd9c1;
        --accent-2: #6aa9ff;
      }

      body {
        margin: 0;
        font-family: "Inter", system-ui, sans-serif;
        background: var(--bg);
        color: var(--text);
        display: grid;
        place-items: center;
        min-height: 100vh;
      }

      .game {
        width: min(640px, 92vw);
        background: var(--panel);
        border-radius: 20px;
        padding: 20px;
        box-shadow: 0 16px 40px rgba(0, 0, 0, 0.45);
        display: grid;
        gap: 16px;
      }

      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      canvas {
        width: 100%;
        height: 360px;
        border-radius: 16px;
        background: #0f1320;
        display: block;
      }

      .controls {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        align-items: center;
      }

      button {
        border: none;
        border-radius: 999px;
        padding: 10px 16px;
        background: var(--accent);
        color: #0f172a;
        font-weight: 600;
        cursor: pointer;
      }

      .score {
        font-size: 0.95rem;
        color: #cbd5f5;
      }
    </style>
  </head>
  <body>
    <div class="game">
      <header>
        <div>
          <h1 id="title" style="margin: 0; font-size: 1.4rem;">Tap Dash</h1>
          <p style="margin: 4px 0 0; color: #a3adc2; font-size: 0.9rem;">
            Tap the glowing orb before it escapes.
          </p>
        </div>
        <div class="score" id="score">Score: 0 · Misses: 0</div>
      </header>
      <canvas id="canvas" width="640" height="360" aria-label="Tap game canvas"></canvas>
      <div class="controls">
        <button id="start">Start</button>
        <button id="reset">Reset</button>
        <span id="status" class="score">Ready.</span>
      </div>
    </div>

    <script>
      const params = new URLSearchParams(window.location.search);
      const seed = Number(params.get("seed") || 1);
      const title = params.get("title") || "Tap Dash";
      document.getElementById("title").textContent = title;

      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");

      let running = false;
      let score = 0;
      let misses = 0;
      let orb = { x: 120, y: 120, r: 18, vx: 2.4, vy: 1.8 };

      const status = document.getElementById("status");
      const scoreEl = document.getElementById("score");

      const rng = (() => {
        let value = seed % 2147483647;
        return () => (value = (value * 16807) % 2147483647) / 2147483647;
      })();

      const setScore = () => {
        scoreEl.textContent = `Score: ${score} · Misses: ${misses}`;
      };

      const resetOrb = () => {
        orb.x = 60 + rng() * (canvas.width - 120);
        orb.y = 60 + rng() * (canvas.height - 120);
        orb.vx = (rng() * 2 + 1.5) * (rng() > 0.5 ? 1 : -1);
        orb.vy = (rng() * 2 + 1.2) * (rng() > 0.5 ? 1 : -1);
      };

      const update = () => {
        if (!running) return;
        orb.x += orb.vx;
        orb.y += orb.vy;

        if (orb.x < orb.r || orb.x > canvas.width - orb.r) orb.vx *= -1;
        if (orb.y < orb.r || orb.y > canvas.height - orb.r) orb.vy *= -1;

        draw();
        requestAnimationFrame(update);
      };

      const draw = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const gradient = ctx.createRadialGradient(orb.x, orb.y, 2, orb.x, orb.y, orb.r * 2.2);
        gradient.addColorStop(0, "rgba(93, 217, 193, 0.9)");
        gradient.addColorStop(1, "rgba(93, 217, 193, 0.05)");
        ctx.fillStyle = gradient;
        ctx.beginPath();
        ctx.arc(orb.x, orb.y, orb.r * 2.2, 0, Math.PI * 2);
        ctx.fill();

        ctx.fillStyle = "#5dd9c1";
        ctx.beginPath();
        ctx.arc(orb.x, orb.y, orb.r, 0, Math.PI * 2);
        ctx.fill();
      };

      canvas.addEventListener("click", (event) => {
        if (!running) return;
        const rect = canvas.getBoundingClientRect();
        const x = ((event.clientX - rect.left) / rect.width) * canvas.width;
        const y = ((event.clientY - rect.top) / rect.height) * canvas.height;
        const distance = Math.hypot(x - orb.x, y - orb.y);

        if (distance <= orb.r * 1.4) {
          score += 1;
          status.textContent = "Nice hit!";
          resetOrb();
        } else {
          misses += 1;
          status.textContent = "Missed! Try again.";
        }
        setScore();
      });

      document.getElementById("start").addEventListener("click", () => {
        if (!running) {
          running = true;
          status.textContent = "Go!";
          update();
        }
      });

      document.getElementById("reset").addEventListener("click", () => {
        running = false;
        score = 0;
        misses = 0;
        resetOrb();
        setScore();
        draw();
        status.textContent = "Ready.";
      });

      resetOrb();
      draw();
      setScore();
    </script>
  </body>
</html>
